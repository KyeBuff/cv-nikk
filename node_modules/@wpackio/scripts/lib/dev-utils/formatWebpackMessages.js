"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.formatWebpackMessages = formatWebpackMessages;

/* eslint-disable no-param-reassign */
const friendlySyntaxErrorLabel = 'Syntax error:';

function isLikelyASyntaxError(message) {
  return message.indexOf(friendlySyntaxErrorLabel) !== -1;
} // Cleans up webpack error messages.


function formatMessage(message) {
  let lines = message.split('\n'); // Strip webpack-added headers off errors/warnings
  // https://github.com/webpack/webpack/blob/master/lib/ModuleError.js

  lines = lines.filter(line => !/Module [A-z ]+\(from/.test(line)); // Transform parsing error into syntax error
  // TODO: move this to our ESLint formatter?

  lines = lines.map(line => {
    const parsingError = /Line (\d+):(?:(\d+):)?\s*Parsing error: (.+)$/.exec(line);

    if (!parsingError) {
      return line;
    }

    const [, errorLine, errorColumn, errorMessage] = parsingError;
    return `${friendlySyntaxErrorLabel} ${errorMessage} (${errorLine}:${errorColumn})`;
  });
  message = lines.join('\n'); // Smoosh syntax errors (commonly found in CSS)

  message = message.replace(/SyntaxError\s+\((\d+):(\d+)\)\s*(.+?)\n/g, `${friendlySyntaxErrorLabel} $3 ($1:$2)\n`); // Clean up export errors

  message = message.replace(/^.*export '(.+?)' was not found in '(.+?)'.*$/gm, `Attempted import error: '$1' is not exported from '$2'.`);
  message = message.replace(/^.*export 'default' \(imported as '(.+?)'\) was not found in '(.+?)'.*$/gm, `Attempted import error: '$2' does not contain a default export (imported as '$1').`);
  message = message.replace(/^.*export '(.+?)' \(imported as '(.+?)'\) was not found in '(.+?)'.*$/gm, `Attempted import error: '$1' is not exported from '$3' (imported as '$2').`);
  lines = message.split('\n'); // Remove leading newline

  if (lines.length > 2 && lines[1].trim() === '') {
    lines.splice(1, 1);
  } // Clean up file name


  lines[0] = lines[0].replace(/^(.*) \d+:\d+-\d+$/, '$1'); // Cleans up verbose "module not found" messages for files and packages.

  if (lines[1] && lines[1].indexOf('Module not found: ') === 0) {
    lines = [lines[0], lines[1].replace('Error: ', '').replace('Module not found: Cannot find file:', 'Cannot find file:')];
  } // Add helpful message for users trying to use Sass for the first time


  if (lines[1] && lines[1].match(/Cannot find module.+node-sass/)) {
    lines[1] = 'To import Sass files, you first need to install node-sass.\n';
    lines[1] += 'Run `npm install node-sass` or `yarn add node-sass` inside your workspace.';
  }

  message = lines.join('\n'); // Internal stacks are generally useless so we strip them... with the
  // exception of stacks containing `webpack:` because they're normally
  // from user code generated by webpack. For more information see
  // https://github.com/facebook/create-react-app/pull/1050

  message = message.replace(/^\s*at\s((?!webpack:).)*:\d+:\d+[\s)]*(\n|$)/gm, ''); // at ... ...:x:y

  message = message.replace(/^\s*at\s<anonymous>(\n|$)/gm, ''); // at <anonymous>

  lines = message.split('\n'); // Remove duplicated newlines

  lines = lines.filter((line, index, arr) => index === 0 || line.trim() !== '' || line.trim() !== arr[index - 1].trim()); // Reassemble the message

  message = lines.join('\n');
  return message.trim();
}

function formatWebpackMessages(json) {
  const formattedErrors = json.errors.map(formatMessage);
  const formattedWarnings = json.warnings.map(formatMessage);
  const result = {
    errors: formattedErrors,
    warnings: formattedWarnings
  };

  if (result.errors.some(isLikelyASyntaxError)) {
    // If there are any syntax errors, show just them.
    result.errors = result.errors.filter(isLikelyASyntaxError);
  }

  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kZXYtdXRpbHMvZm9ybWF0V2VicGFja01lc3NhZ2VzLnRzIl0sIm5hbWVzIjpbImZyaWVuZGx5U3ludGF4RXJyb3JMYWJlbCIsImlzTGlrZWx5QVN5bnRheEVycm9yIiwibWVzc2FnZSIsImluZGV4T2YiLCJmb3JtYXRNZXNzYWdlIiwibGluZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0ZXN0IiwibWFwIiwicGFyc2luZ0Vycm9yIiwiZXhlYyIsImVycm9yTGluZSIsImVycm9yQ29sdW1uIiwiZXJyb3JNZXNzYWdlIiwiam9pbiIsInJlcGxhY2UiLCJsZW5ndGgiLCJ0cmltIiwic3BsaWNlIiwibWF0Y2giLCJpbmRleCIsImFyciIsImZvcm1hdFdlYnBhY2tNZXNzYWdlcyIsImpzb24iLCJmb3JtYXR0ZWRFcnJvcnMiLCJlcnJvcnMiLCJmb3JtYXR0ZWRXYXJuaW5ncyIsIndhcm5pbmdzIiwicmVzdWx0Iiwic29tZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBR0EsTUFBTUEsd0JBQWdDLEdBQUcsZUFBekM7O0FBRUEsU0FBU0Msb0JBQVQsQ0FBOEJDLE9BQTlCLEVBQStDO0FBQzlDLFNBQU9BLE9BQU8sQ0FBQ0MsT0FBUixDQUFnQkgsd0JBQWhCLE1BQThDLENBQUMsQ0FBdEQ7QUFDQSxDLENBRUQ7OztBQUNBLFNBQVNJLGFBQVQsQ0FBdUJGLE9BQXZCLEVBQXdDO0FBQ3ZDLE1BQUlHLEtBQUssR0FBR0gsT0FBTyxDQUFDSSxLQUFSLENBQWMsSUFBZCxDQUFaLENBRHVDLENBR3ZDO0FBQ0E7O0FBQ0FELEVBQUFBLEtBQUssR0FBR0EsS0FBSyxDQUFDRSxNQUFOLENBQWFDLElBQUksSUFBSSxDQUFDLHVCQUF1QkMsSUFBdkIsQ0FBNEJELElBQTVCLENBQXRCLENBQVIsQ0FMdUMsQ0FPdkM7QUFDQTs7QUFDQUgsRUFBQUEsS0FBSyxHQUFHQSxLQUFLLENBQUNLLEdBQU4sQ0FBVUYsSUFBSSxJQUFJO0FBQ3pCLFVBQU1HLFlB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SyxLQUFLLENBQVYsSUFBZWQsSUFBSSxDQUFDVyxJQUFMLE9BQWdCLEVBQS9CLElBQXFDWCxJQUFJLENBQUNXLElBQUwsT0FBZ0JJLEdBQUcsQ0FBQ0QsS0FBSyxHQUFHLENBQVQsQ0FBSCxDQUFlSCxJQUFmLEVBRi9DLENBQVIsQ0E5RXVDLENBbUZ2Qzs7QUFDQWpCLEVBQUFBLE9BQU8sR0FBR0csS0FBSyxDQUFDVyxJQUFOLENBQVcsSUFBWCxDQUFWO0FBQ0EsU0FBT2QsT0FBTyxDQUFDaUIsSUFBUixFQUFQO0FBQ0E7O0FBRU0sU0FBU0sscUJBQVQsQ0FDTkMsSUFETSxFQUVMO0FBQ0QsUUFBTUMsZUFBZSxHQUFHRCxJQUFJLENBQUNFLE1BQUwsQ0FBWWpCLEdBQVosQ0FBZ0JOLGFBQWhCLENBQXhCO0FBQ0EsUUFBTXdCLGlCQUFpQixHQUFHSCxJQUFJLENBQUNJLFFBQUwsQ0FBY25CLEdBQWQsQ0FBa0JOLGFBQWxCLENBQTFCO0FBQ0EsUUFBTTBCLE1BQU0sR0FBRztBQUFFSCxJQUFBQSxNQUFNLEVBQUVELGVBQVY7QUFBMkJHLElBQUFBLFFBQVEsRUFBRUQ7QUFBckMsR0FBZjs7QUFDQSxNQUFJRSxNQUFNLENBQUNILE1BQVAsQ0FBY0ksSUFBZCxDQUFtQjlCLG9CQUFuQixDQUFKLEVBQThDO0FBQzdDO0FBQ0E2QixJQUFBQSxNQUFNLENBQUNILE1BQVAsR0FBZ0JHLE1BQU0sQ0FBQ0gsTUFBUCxDQUFjcEIsTUFBZCxDQUFxQk4sb0JBQXJCLENBQWhCO0FBQ0E7O0FBQ0QsU0FBTzZCLE1BQVA7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG5pbXBvcnQgeyBTdGF0cyB9IGZyb20gJ3dlYnBhY2snO1xuXG5jb25zdCBmcmllbmRseVN5bnRheEVycm9yTGFiZWw6IHN0cmluZyA9ICdTeW50YXggZXJyb3I6JztcblxuZnVuY3Rpb24gaXNMaWtlbHlBU3ludGF4RXJyb3IobWVzc2FnZTogc3RyaW5nKSB7XG5cdHJldHVybiBtZXNzYWdlLmluZGV4T2YoZnJpZW5kbHlTeW50YXhFcnJvckxhYmVsKSAhPT0gLTE7XG59XG5cbi8vIENsZWFucyB1cCB3ZWJwYWNrIGVycm9yIG1lc3NhZ2VzLlxuZnVuY3Rpb24gZm9ybWF0TWVzc2FnZShtZXNzYWdlOiBzdHJpbmcpIHtcblx0bGV0IGxpbmVzID0gbWVzc2FnZS5zcGxpdCgnXFxuJyk7XG5cblx0Ly8gU3RyaXAgd2VicGFjay1hZGRlZCBoZWFkZXJzIG9mZiBlcnJvcnMvd2FybmluZ3Ncblx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2svd2VicGFjay9ibG9iL21hc3Rlci9saWIvTW9kdWxlRXJyb3IuanNcblx0bGluZXMgPSBsaW5lcy5maWx0ZXIobGluZSA9PiAhL01vZHVsZSBbQS16IF0rXFwoZnJvbS8udGVzdChsaW5lKSk7XG5cblx0Ly8gVHJhbnNmb3JtIHBhcnNpbmcgZXJyb3IgaW50byBzeW50YXggZXJyb3Jcblx0Ly8gVE9ETzogbW92ZSB0aGlzIHRvIG91ciBFU0xpbnQgZm9ybWF0dGVyP1xuXHRsaW5lcyA9IGxpbmVzLm1hcChsaW5lID0+IHtcblx0XHRjb25zdCBwYXJzaW5nRXJyb3IgPSAvTGluZSAoXFxkKyk6KD86KFxcZCspOik/XFxzKlBhcnNpbmcgZXJyb3I6ICguKykkLy5leGVjKFxuXHRcdFx0bGluZVxuXHRcdCk7XG5cdFx0aWYgKCFwYXJzaW5nRXJyb3IpIHtcblx0XHRcdHJldHVybiBsaW5lO1xuXHRcdH1cblx0XHRjb25zdCBbLCBlcnJvckxpbmUsIGVycm9yQ29sdW1uLCBlcnJvck1lc3NhZ2VdID0gcGFyc2luZ0Vycm9yO1xuXHRcdHJldHVybiBgJHtmcmllbmRseVN5bnRheEVycm9yTGFiZWx9ICR7ZXJyb3JNZXNzYWdlfSAoJHtlcnJvckxpbmV9OiR7ZXJyb3JDb2x1bW59KWA7XG5cdH0pO1xuXG5cdG1lc3NhZ2UgPSBsaW5lcy5qb2luKCdcXG4nKTtcblx0Ly8gU21vb3NoIHN5bnRheCBlcnJvcnMgKGNvbW1vbmx5IGZvdW5kIGluIENTUylcblx0bWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShcblx0XHQvU3ludGF4RXJyb3JcXHMrXFwoKFxcZCspOihcXGQrKVxcKVxccyooLis/KVxcbi9nLFxuXHRcdGAke2ZyaWVuZGx5U3ludGF4RXJyb3JMYWJlbH0gJDMgKCQxOiQyKVxcbmBcblx0KTtcblx0Ly8gQ2xlYW4gdXAgZXhwb3J0IGVycm9yc1xuXHRtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKFxuXHRcdC9eLipleHBvcnQgJyguKz8pJyB3YXMgbm90IGZvdW5kIGluICcoLis/KScuKiQvZ20sXG5cdFx0YEF0dGVtcHRlZCBpbXBvcnQgZXJyb3I6ICckMScgaXMgbm90IGV4cG9ydGVkIGZyb20gJyQyJy5gXG5cdCk7XG5cdG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoXG5cdFx0L14uKmV4cG9ydCAnZGVmYXVsdCcgXFwoaW1wb3J0ZWQgYXMgJyguKz8pJ1xcKSB3YXMgbm90IGZvdW5kIGluICcoLis/KScuKiQvZ20sXG5cdFx0YEF0dGVtcHRlZCBpbXBvcnQgZXJyb3I6ICckMicgZG9lcyBub3QgY29udGFpbiBhIGRlZmF1bHQgZXhwb3J0IChpbXBvcnRlZCBhcyAnJDEnKS5gXG5cdCk7XG5cdG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoXG5cdFx0L14uKmV4cG9ydCAnKC4rPyknIFxcKGltcG9ydGVkIGFzICcoLis/KSdcXCkgd2FzIG5vdCBmb3VuZCBpbiAnKC4rPyknLiokL2dtLFxuXHRcdGBBdHRlbXB0ZWQgaW1wb3J0IGVycm9yOiAnJDEnIGlzIG5vdCBleHBvcnRlZCBmcm9tICckMycgKGltcG9ydGVkIGFzICckMicpLmBcblx0KTtcblx0bGluZXMgPSBtZXNzYWdlLnNwbGl0KCdcXG4nKTtcblxuXHQvLyBSZW1vdmUgbGVhZGluZyBuZXdsaW5lXG5cdGlmIChsaW5lcy5sZW5ndGggPiAyICYmIGxpbmVzWzFdLnRyaW0oKSA9PT0gJycpIHtcblx0XHRsaW5lcy5zcGxpY2UoMSwgMSk7XG5cdH1cblx0Ly8gQ2xlYW4gdXAgZmlsZSBuYW1lXG5cdGxpbmVzWzBdID0gbGluZXNbMF0ucmVwbGFjZSgvXiguKikgXFxkKzpcXGQrLVxcZCskLywgJyQxJyk7XG5cblx0Ly8gQ2xlYW5zIHVwIHZlcmJvc2UgXCJtb2R1bGUgbm90IGZvdW5kXCIgbWVzc2FnZXMgZm9yIGZpbGVzIGFuZCBwYWNrYWdlcy5cblx0aWYgKGxpbmVzWzFdICYmIGxpbmVzWzFdLmluZGV4T2YoJ01vZHVsZSBub3QgZm91bmQ6ICcpID09PSAwKSB7XG5cdFx0bGluZXMgPSBbXG5cdFx0XHRsaW5lc1swXSxcblx0XHRcdGxpbmVzWzFdXG5cdFx0XHRcdC5yZXBsYWNlKCdFcnJvcjogJywgJycpXG5cdFx0XHRcdC5yZXBsYWNlKCdNb2R1bGUgbm90IGZvdW5kOiBDYW5ub3QgZmluZCBmaWxlOicsICdDYW5ub3QgZmluZCBmaWxlOicpLFxuXHRcdF07XG5cdH1cblxuXHQvLyBBZGQgaGVscGZ1bCBtZXNzYWdlIGZvciB1c2VycyB0cnlpbmcgdG8gdXNlIFNhc3MgZm9yIHRoZSBmaXJzdCB0aW1lXG5cdGlmIChsaW5lc1sxXSAmJiBsaW5lc1sxXS5tYXRjaCgvQ2Fubm90IGZpbmQgbW9kdWxlLitub2RlLXNhc3MvKSkge1xuXHRcdGxpbmVzWzFdID0gJ1RvIGltcG9ydCBTYXNzIGZpbGVzLCB5b3UgZmlyc3QgbmVlZCB0byBpbnN0YWxsIG5vZGUtc2Fzcy5cXG4nO1xuXHRcdGxpbmVzWzFdICs9XG5cdFx0XHQnUnVuIGBucG0gaW5zdGFsbCBub2RlLXNhc3NgIG9yIGB5YXJuIGFkZCBub2RlLXNhc3NgIGluc2lkZSB5b3VyIHdvcmtzcGFjZS4nO1xuXHR9XG5cblx0bWVzc2FnZSA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuXHQvLyBJbnRlcm5hbCBzdGFja3MgYXJlIGdlbmVyYWxseSB1c2VsZXNzIHNvIHdlIHN0cmlwIHRoZW0uLi4gd2l0aCB0aGVcblx0Ly8gZXhjZXB0aW9uIG9mIHN0YWNrcyBjb250YWluaW5nIGB3ZWJwYWNrOmAgYmVjYXVzZSB0aGV5J3JlIG5vcm1hbGx5XG5cdC8vIGZyb20gdXNlciBjb2RlIGdlbmVyYXRlZCBieSB3ZWJwYWNrLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBzZWVcblx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2NyZWF0ZS1yZWFjdC1hcHAvcHVsbC8xMDUwXG5cdG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoXG5cdFx0L15cXHMqYXRcXHMoKD8hd2VicGFjazopLikqOlxcZCs6XFxkK1tcXHMpXSooXFxufCQpL2dtLFxuXHRcdCcnXG5cdCk7IC8vIGF0IC4uLiAuLi46eDp5XG5cdG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoL15cXHMqYXRcXHM8YW5vbnltb3VzPihcXG58JCkvZ20sICcnKTsgLy8gYXQgPGFub255bW91cz5cblx0bGluZXMgPSBtZXNzYWdlLnNwbGl0KCdcXG4nKTtcblxuXHQvLyBSZW1vdmUgZHVwbGljYXRlZCBuZXdsaW5lc1xuXHRsaW5lcyA9IGxpbmVzLmZpbHRlcihcblx0XHQobGluZSwgaW5kZXgsIGFycikgPT5cblx0XHRcdGluZGV4ID09PSAwIHx8IGxpbmUudHJpbSgpICE9PSAnJyB8fCBsaW5lLnRyaW0oKSAhPT0gYXJyW2luZGV4IC0gMV0udHJpbSgpXG5cdCk7XG5cblx0Ly8gUmVhc3NlbWJsZSB0aGUgbWVzc2FnZVxuXHRtZXNzYWdlID0gbGluZXMuam9pbignXFxuJyk7XG5cdHJldHVybiBtZXNzYWdlLnRyaW0oKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFdlYnBhY2tNZXNzYWdlcyhcblx0anNvbjogU3RhdHMuVG9Kc29uT3V0cHV0IHwgeyBlcnJvcnM6IHN0cmluZ1tdOyB3YXJuaW5nczogc3RyaW5nW10gfVxuKSB7XG5cdGNvbnN0IGZvcm1hdHRlZEVycm9ycyA9IGpzb24uZXJyb3JzLm1hcChmb3JtYXRNZXNzYWdlKTtcblx0Y29uc3QgZm9ybWF0dGVkV2FybmluZ3MgPSBqc29uLndhcm5pbmdzLm1hcChmb3JtYXRNZXNzYWdlKTtcblx0Y29uc3QgcmVzdWx0ID0geyBlcnJvcnM6IGZvcm1hdHRlZEVycm9ycywgd2FybmluZ3M6IGZvcm1hdHRlZFdhcm5pbmdzIH07XG5cdGlmIChyZXN1bHQuZXJyb3JzLnNvbWUoaXNMaWtlbHlBU3ludGF4RXJyb3IpKSB7XG5cdFx0Ly8gSWYgdGhlcmUgYXJlIGFueSBzeW50YXggZXJyb3JzLCBzaG93IGp1c3QgdGhlbS5cblx0XHRyZXN1bHQuZXJyb3JzID0gcmVzdWx0LmVycm9ycy5maWx0ZXIoaXNMaWtlbHlBU3ludGF4RXJyb3IpO1xuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59XG4iXX0=