"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.WatchMissingNodeModulesPlugin = void 0;

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class WatchMissingNodeModulesPlugin {
  constructor(nodeModulesPath) {
    _defineProperty(this, "nodeModulesPath", void 0);

    this.nodeModulesPath = nodeModulesPath;
  }

  apply(compiler) {
    compiler.hooks.emit.tap('WatchMissingNodeModulesPlugin', compilation => {
      const missingDeps = Array.from(compilation.missingDependencies);
      const nodeModulesPath = this.nodeModulesPath; // If any missing files are expected to appear in node_modules...

      if (missingDeps.some(file => file.includes(nodeModulesPath))) {
        // ...tell webpack to watch node_modules recursively until they appear.
        compilation.contextDependencies.add(nodeModulesPath);
      }
    });
  }

}

exports.WatchMissingNodeModulesPlugin = WatchMissingNodeModulesPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kZXYtdXRpbHMvV2F0Y2hNaXNzaW5nTm9kZU1vZHVsZXMudHMiXSwibmFtZXMiOlsiV2F0Y2hNaXNzaW5nTm9kZU1vZHVsZXNQbHVnaW4iLCJjb25zdHJ1Y3RvciIsIm5vZGVNb2R1bGVzUGF0aCIsImFwcGx5IiwiY29tcGlsZXIiLCJob29rcyIsImVtaXQiLCJ0YXAiLCJjb21waWxhdGlvbiIsIm1pc3NpbmdEZXBzIiwiQXJyYXkiLCJmcm9tIiwibWlzc2luZ0RlcGVuZGVuY2llcyIsInNvbWUiLCJmaWxlIiwiaW5jbHVkZXMiLCJjb250ZXh0RGVwZW5kZW5jaWVzIiwiYWRkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFTyxNQUFNQSw2QkFBTixDQUFvQztBQUUxQ0MsRUFBQUEsV0FBVyxDQUFDQyxlQUFELEVBQTBCO0FBQUE7O0FBQ3BDLFNBQUtBLGVBQUwsR0FBdUJBLGVBQXZCO0FBQ0E7O0FBRURDLEVBQUFBLEtBQUssQ0FBQ0MsUUFBRCxFQUFxQjtBQUN6QkEsSUFBQUEsUUFBUSxDQUFDQyxLQUFULENBQWVDLElBQWYsQ0FBb0JDLEdBQXBCLENBQXdCLCtCQUF4QixFQUF5REMsV0FBVyxJQUFJO0FBQ3ZFLFlBQU1DLFdBQVcsR0FBR0MsS0FBSyxDQUFDQyxJQUFOLENBQVdILFdBQVcsQ0FBQ0ksbUJBQXZCLENBQXBCO0FBQ0EsWUFBTVYsZUFBZSxHQUFHLEtBQUtBLGVBQTdCLENBRnVFLENBSXZFOztBQUNBLFVBQUlPLFdBQVcsQ0FBQ0ksSUFBWixDQUFpQkMsSUFBSSxJQUFJQSxJQUFJLENBQUNDLFFBQUwsQ0FBY2IsZUFBZCxDQUF6QixDQUFKLEVBQThEO0FBQzdEO0FBQ0FNLFFBQUFBLFdBQVcsQ0FBQ1EsbUJBQVosQ0FBZ0NDLEdBQWhDLENBQW9DZixlQUFwQztBQUNBO0FBQ0QsS0FURDtBQVVBOztBQWpCeUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21waWxlciB9IGZyb20gJ3dlYnBhY2snO1xuXG5leHBvcnQgY2xhc3MgV2F0Y2hNaXNzaW5nTm9kZU1vZHVsZXNQbHVnaW4ge1xuXHRub2RlTW9kdWxlc1BhdGg6IHN0cmluZztcblx0Y29uc3RydWN0b3Iobm9kZU1vZHVsZXNQYXRoOiBzdHJpbmcpIHtcblx0XHR0aGlzLm5vZGVNb2R1bGVzUGF0aCA9IG5vZGVNb2R1bGVzUGF0aDtcblx0fVxuXG5cdGFwcGx5KGNvbXBpbGVyOiBDb21waWxlcikge1xuXHRcdGNvbXBpbGVyLmhvb2tzLmVtaXQudGFwKCdXYXRjaE1pc3NpbmdOb2RlTW9kdWxlc1BsdWdpbicsIGNvbXBpbGF0aW9uID0+IHtcblx0XHRcdGNvbnN0IG1pc3NpbmdEZXBzID0gQXJyYXkuZnJvbShjb21waWxhdGlvbi5taXNzaW5nRGVwZW5kZW5jaWVzKTtcblx0XHRcdGNvbnN0IG5vZGVNb2R1bGVzUGF0aCA9IHRoaXMubm9kZU1vZHVsZXNQYXRoO1xuXG5cdFx0XHQvLyBJZiBhbnkgbWlzc2luZyBmaWxlcyBhcmUgZXhwZWN0ZWQgdG8gYXBwZWFyIGluIG5vZGVfbW9kdWxlcy4uLlxuXHRcdFx0aWYgKG1pc3NpbmdEZXBzLnNvbWUoZmlsZSA9PiBmaWxlLmluY2x1ZGVzKG5vZGVNb2R1bGVzUGF0aCkpKSB7XG5cdFx0XHRcdC8vIC4uLnRlbGwgd2VicGFjayB0byB3YXRjaCBub2RlX21vZHVsZXMgcmVjdXJzaXZlbHkgdW50aWwgdGhleSBhcHBlYXIuXG5cdFx0XHRcdGNvbXBpbGF0aW9uLmNvbnRleHREZXBlbmRlbmNpZXMuYWRkKG5vZGVNb2R1bGVzUGF0aCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn1cbiJdfQ==