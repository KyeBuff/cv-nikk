"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.bootstrap = bootstrap;

var _chalk = _interopRequireDefault(require("chalk"));

var _execa = _interopRequireDefault(require("execa"));

var _logSymbols = _interopRequireDefault(require("log-symbols"));

var _ora = _interopRequireDefault(require("ora"));

var _prettyError = _interopRequireDefault(require("pretty-error"));

var _Bootstrap = require("../scripts/Bootstrap");

var _utils = require("./utils");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

async function bootstrap(options, version) {
  // For error handling
  const pe = new _prettyError.default();
  const cwd = (0, _utils.resolveCWD)(options);
  console.log(`ðŸ“¦ bootstraping ${_utils.wpackLogoSmall} into your project`);

  try {
    const initiator = new _Bootstrap.Bootstrap(cwd, version);

    try {
      const done = await initiator.bootstrap();

      if (done.configured === 'project') {
        console.log(`${_logSymbols.default.success} ${_utils.wpackLogoSmall} bootstrap complete!`);
        console.log(`${_logSymbols.default.success} project config created at ${_chalk.default.yellow('./wpackio.project.js')}`);
      } else if (done.configured === 'server') {
        console.log(`${_logSymbols.default.success} server configuration complete!`);
        console.log(`${_logSymbols.default.success} server config created at ${_chalk.default.yellow('./wpackio.server.js')}`);
      } else {
        console.log(`${_logSymbols.default.info} project and server configuration already present.`);
        console.log(`${_logSymbols.default.info} updating dependencies.`);
      } // Install all dependencies from `done` if any


      const command = (0, _utils.isYarn)() ? 'yarn' : 'npm';
      const add = (0, _utils.isYarn)() ? 'add' : 'i';
      const devParam = (0, _utils.isYarn)() ? '--dev' : '-D';
      const spinner = (0, _ora.default)({
        spinner: 'dots3',
        discardStdin: false
      });

      if (done.deps && done.deps.dependencies.length) {
        console.log(`${_logSymbols.default.info} need to install following ${_chalk.default.yellow('dependencies')}\n`);
        console.log(`    ${_utils.bulletSymbol} ${_chalk.default.yellow(done.deps.dependencies.join(', '))}\n`);
        spinner.start(`installing dependencies${_utils.watchEllipsis} may take a while`);

        try {
          await (0, _execa.default)(command, [add, ...done.deps.dependencies]);
          spinner.succeed('done installing dependencies\n');
        } catch (e) {
          spinner.fail('could not install all dependencies');
          console.log(pe.render(e));
        }
      }

      if (done.deps && done.deps.devDependencies.length) {
        console.log(`${_logSymbols.default.info} need to install following ${_chalk.default.yellow('dev dependencies')}\n`);
        console.log(`    ${_utils.bulletSymbol} ${_chalk.default.green(done.deps.devDependencies.join(', '))}\n`);
        spinner.start(`installing dev dependencies${_utils.watchEllipsis} may take a while`);

        try {
          await (0, _execa.default)(command, [add, ...done.deps.devDependencies, devParam]);
          spinner.succeed('done installing devDependencies\n');
        } catch (e) {
          spinner.fail('could not install all devDependencies');
          console.log(pe.render(e));
        }
      }
    } catch (e) {
      console.log(`${_logSymbols.default.error} something went wrong trying to bootstrap.`);
      console.log(pe.render(e));
    } // Log how to access and start, develop, build etc.


    console.log('');
    (0, _utils.endBootstrapInfo)();
    console.log('');
  } catch (e) {
    console.log(pe.render(e));
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iaW4vYm9vdHN0cmFwLnRzIl0sIm5hbWVzIjpbImJvb3RzdHJhcCIsIm9wdGlvbnMiLCJ2ZXJzaW9uIiwicGUiLCJQcmV0dHlFcnJvciIsImN3ZCIsImNvbnNvbGUiLCJsb2ciLCJ3cGFja0xvZ29TbWFsbCIsImluaXRpYXRvciIsIkJvb3RzdHJhcCIsImRvbmUiLCJjb25maWd1cmVkIiwibG9nU3ltYm9scyIsInN1Y2Nlc3MiLCJjaGFsayIsInllbGxvdyIsImluZm8iLCJjb21tYW5kIiwiYWRkIiwiZGV2UGFyYW0iLCJzcGlubmVyIiwiZGlzY2FyZFN0ZGluIiwiZGVwcyIsImRlcGVuZGVuY2llcyIsImxlbmd0aCIsImJ1bGxldFN5bWJvbCIsImpvaW4iLCJzdGFydCIsIndhdGNoRWxsaXBzaXMiLCJzdWNjZWVkIiwiZSIsImZhaWwiLCJyZW5kZXIiLCJkZXZEZXBlbmRlbmNpZXMiLCJncmVlbiIsImVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7Ozs7QUFTTyxlQUFlQSxTQUFmLENBQ05DLE9BRE0sRUFFTkMsT0FGTSxFQUdVO0FBQ2hCO0FBQ0EsUUFBTUMsRUFBRSxHQUFHLElBQUlDLG9CQUFKLEVBQVg7QUFDQSxRQUFNQyxHQUFHLEdBQUcsdUJBQVdKLE9BQVgsQ0FBWjtBQUNBSyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxtQkFBa0JDLHFCQUFlLG9CQUE5Qzs7QUFDQSxNQUFJO0FBQ0gsVUFBTUMsU0FBUyxHQUFHLElBQUlDLG9CQUFKLENBQWNMLEdBQWQsRUFBbUJILE9BQW5CLENBQWxCOztBQUVBLFFBQUk7QUFDSCxZQUFNUyxJQUFJLEdBQUcsTUFBTUYsU0FBUyxDQUFDVCxTQUFWLEVBQW5COztBQUVBLFVBQUlXLElBQUksQ0FBQ0MsVUFBTCxLQUFvQixTQUF4QixFQUFtQztBQUNsQ04sUUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQ0UsR0FBRU0s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QUksQ0FBQ1ksSUFBTCxDQUFVVyxlQUFuQixFQUFvQ2QsUUFBcEMsQ0FBZixDQUFOO0FBQ0FDLFVBQUFBLE9BQU8sQ0FBQ1MsT0FBUixDQUFnQixtQ0FBaEI7QUFDQSxTQUhELENBR0UsT0FBT0MsQ0FBUCxFQUFVO0FBQ1hWLFVBQUFBLE9BQU8sQ0FBQ1csSUFBUixDQUFhLHVDQUFiO0FBQ0ExQixVQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosRUFBRSxDQUFDOEIsTUFBSCxDQUFVRixDQUFWLENBQVo7QUFDQTtBQUNEO0FBQ0QsS0E5RUQsQ0E4RUUsT0FBT0EsQ0FBUCxFQUFVO0FBQ1h6QixNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FDRSxHQUFFTSxvQkFBV3VCLEtBQU0sNENBRHJCO0FBR0E5QixNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosRUFBRSxDQUFDOEIsTUFBSCxDQUFVRixDQUFWLENBQVo7QUFDQSxLQXRGRSxDQXdGSDs7O0FBQ0F6QixJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxFQUFaO0FBQ0E7QUFDQUQsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksRUFBWjtBQUNBLEdBNUZELENBNEZFLE9BQU93QixDQUFQLEVBQVU7QUFDWHpCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSixFQUFFLENBQUM4QixNQUFILENBQVVGLENBQVYsQ0FBWjtBQUNBO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuaW1wb3J0IGV4ZWNhIGZyb20gJ2V4ZWNhJztcbmltcG9ydCBsb2dTeW1ib2xzIGZyb20gJ2xvZy1zeW1ib2xzJztcbmltcG9ydCBvcmEgZnJvbSAnb3JhJztcbmltcG9ydCBQcmV0dHlFcnJvciBmcm9tICdwcmV0dHktZXJyb3InO1xuXG5pbXBvcnQgeyBQcm9ncmFtT3B0aW9ucyB9IGZyb20gJy4nO1xuaW1wb3J0IHsgQm9vdHN0cmFwIH0gZnJvbSAnLi4vc2NyaXB0cy9Cb290c3RyYXAnO1xuaW1wb3J0IHtcblx0YnVsbGV0U3ltYm9sLFxuXHRlbmRCb290c3RyYXBJbmZvLFxuXHRpc1lhcm4sXG5cdHJlc29sdmVDV0QsXG5cdHdhdGNoRWxsaXBzaXMsXG5cdHdwYWNrTG9nb1NtYWxsLFxufSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGJvb3RzdHJhcChcblx0b3B0aW9uczogUHJvZ3JhbU9wdGlvbnMgfCB1bmRlZmluZWQsXG5cdHZlcnNpb246IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG5cdC8vIEZvciBlcnJvciBoYW5kbGluZ1xuXHRjb25zdCBwZSA9IG5ldyBQcmV0dHlFcnJvcigpO1xuXHRjb25zdCBjd2QgPSByZXNvbHZlQ1dEKG9wdGlvbnMpO1xuXHRjb25zb2xlLmxvZyhg8J+TpiBib290c3RyYXBpbmcgJHt3cGFja0xvZ29TbWFsbH0gaW50byB5b3VyIHByb2plY3RgKTtcblx0dHJ5IHtcblx0XHRjb25zdCBpbml0aWF0b3IgPSBuZXcgQm9vdHN0cmFwKGN3ZCwgdmVyc2lvbik7XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9uZSA9IGF3YWl0IGluaXRpYXRvci5ib290c3RyYXAoKTtcblxuXHRcdFx0aWYgKGRvbmUuY29uZmlndXJlZCA9PT0gJ3Byb2plY3QnKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0XHRcdGAke2xvZ1N5bWJvbHMuc3VjY2Vzc30gJHt3cGFja0xvZ29TbWFsbH0gYm9vdHN0cmFwIGNvbXBsZXRlIWBcblx0XHRcdFx0KTtcblx0XHRcdFx0Y29uc29sZS5sb2coXG5cdFx0XHRcdFx0YCR7bG9nU3ltYm9scy5zdWNjZXNzfSBwcm9qZWN0IGNvbmZpZyBjcmVhdGVkIGF0ICR7Y2hhbGsueWVsbG93KFxuXHRcdFx0XHRcdFx0Jy4vd3BhY2tpby5wcm9qZWN0LmpzJ1xuXHRcdFx0XHRcdCl9YFxuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIGlmIChkb25lLmNvbmZpZ3VyZWQgPT09ICdzZXJ2ZXInKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGAke2xvZ1N5bWJvbHMuc3VjY2Vzc30gc2VydmVyIGNvbmZpZ3VyYXRpb24gY29tcGxldGUhYCk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0XHRcdGAke2xvZ1N5bWJvbHMuc3VjY2Vzc30gc2VydmVyIGNvbmZpZyBjcmVhdGVkIGF0ICR7Y2hhbGsueWVsbG93KFxuXHRcdFx0XHRcdFx0Jy4vd3BhY2tpby5zZXJ2ZXIuanMnXG5cdFx0XHRcdFx0KX1gXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRgJHtsb2dTeW1ib2xzLmluZm99IHByb2plY3QgYW5kIHNlcnZlciBjb25maWd1cmF0aW9uIGFscmVhZHkgcHJlc2VudC5gXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGAke2xvZ1N5bWJvbHMuaW5mb30gdXBkYXRpbmcgZGVwZW5kZW5jaWVzLmApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBJbnN0YWxsIGFsbCBkZXBlbmRlbmNpZXMgZnJvbSBgZG9uZWAgaWYgYW55XG5cdFx0XHRjb25zdCBjb21tYW5kID0gaXNZYXJuKCkgPyAneWFybicgOiAnbnBtJztcblx0XHRcdGNvbnN0IGFkZCA9IGlzWWFybigpID8gJ2FkZCcgOiAnaSc7XG5cdFx0XHRjb25zdCBkZXZQYXJhbSA9IGlzWWFybigpID8gJy0tZGV2JyA6ICctRCc7XG5cdFx0XHRjb25zdCBzcGlubmVyID0gb3JhKHsgc3Bpbm5lcjogJ2RvdHMzJywgZGlzY2FyZFN0ZGluOiBmYWxzZSB9KTtcblxuXHRcdFx0aWYgKGRvbmUuZGVwcyAmJiBkb25lLmRlcHMuZGVwZW5kZW5jaWVzLmxlbmd0aCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRgJHtsb2dTeW1ib2xzLmluZm99IG5lZWQgdG8gaW5zdGFsbCBmb2xsb3dpbmcgJHtjaGFsay55ZWxsb3coXG5cdFx0XHRcdFx0XHQnZGVwZW5kZW5jaWVzJ1xuXHRcdFx0XHRcdCl9XFxuYFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XHRgICAgICR7YnVsbGV0U3ltYm9sfSAke2NoYWxrLnllbGxvdyhcblx0XHRcdFx0XHRcdGRvbmUuZGVwcy5kZXBlbmRlbmNpZXMuam9pbignLCAnKVxuXHRcdFx0XHRcdCl9XFxuYFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRzcGlubmVyLnN0YXJ0KFxuXHRcdFx0XHRcdGBpbnN0YWxsaW5nIGRlcGVuZGVuY2llcyR7d2F0Y2hFbGxpcHNpc30gbWF5IHRha2UgYSB3aGlsZWBcblx0XHRcdFx0KTtcblxuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGF3YWl0IGV4ZWNhKGNvbW1hbmQsIFthZGQsIC4uLmRvbmUuZGVwcy5kZXBlbmRlbmNpZXNdKTtcblx0XHRcdFx0XHRzcGlubmVyLnN1Y2NlZWQoJ2RvbmUgaW5zdGFsbGluZyBkZXBlbmRlbmNpZXNcXG4nKTtcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdHNwaW5uZXIuZmFpbCgnY291bGQgbm90IGluc3RhbGwgYWxsIGRlcGVuZGVuY2llcycpO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHBlLnJlbmRlcihlKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChkb25lLmRlcHMgJiYgZG9uZS5kZXBzLmRldkRlcGVuZGVuY2llcy5sZW5ndGgpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXG5cdFx0XHRcdFx0YCR7bG9nU3ltYm9scy5pbmZvfSBuZWVkIHRvIGluc3RhbGwgZm9sbG93aW5nICR7Y2hhbGsueWVsbG93KFxuXHRcdFx0XHRcdFx0J2RldiBkZXBlbmRlbmNpZXMnXG5cdFx0XHRcdFx0KX1cXG5gXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0XHRcdGAgICAgJHtidWxsZXRTeW1ib2x9ICR7Y2hhbGsuZ3JlZW4oXG5cdFx0XHRcdFx0XHRkb25lLmRlcHMuZGV2RGVwZW5kZW5jaWVzLmpvaW4oJywgJylcblx0XHRcdFx0XHQpfVxcbmBcblx0XHRcdFx0KTtcblx0XHRcdFx0c3Bpbm5lci5zdGFydChcblx0XHRcdFx0XHRgaW5zdGFsbGluZyBkZXYgZGVwZW5kZW5jaWVzJHt3YXRjaEVsbGlwc2lzfSBtYXkgdGFrZSBhIHdoaWxlYFxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0YXdhaXQgZXhlY2EoY29tbWFuZCwgW2FkZCwgLi4uZG9uZS5kZXBzLmRldkRlcGVuZGVuY2llcywgZGV2UGFyYW1dKTtcblx0XHRcdFx0XHRzcGlubmVyLnN1Y2NlZWQoJ2RvbmUgaW5zdGFsbGluZyBkZXZEZXBlbmRlbmNpZXNcXG4nKTtcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdHNwaW5uZXIuZmFpbCgnY291bGQgbm90IGluc3RhbGwgYWxsIGRldkRlcGVuZGVuY2llcycpO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHBlLnJlbmRlcihlKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0YCR7bG9nU3ltYm9scy5lcnJvcn0gc29tZXRoaW5nIHdlbnQgd3JvbmcgdHJ5aW5nIHRvIGJvb3RzdHJhcC5gXG5cdFx0XHQpO1xuXHRcdFx0Y29uc29sZS5sb2cocGUucmVuZGVyKGUpKTtcblx0XHR9XG5cblx0XHQvLyBMb2cgaG93IHRvIGFjY2VzcyBhbmQgc3RhcnQsIGRldmVsb3AsIGJ1aWxkIGV0Yy5cblx0XHRjb25zb2xlLmxvZygnJyk7XG5cdFx0ZW5kQm9vdHN0cmFwSW5mbygpO1xuXHRcdGNvbnNvbGUubG9nKCcnKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGNvbnNvbGUubG9nKHBlLnJlbmRlcihlKSk7XG5cdH1cbn1cbiJdfQ==